/Users/krysten/MS BME/FALL2025/ml_genomics/SigRelayST/data_preprocess_SigRelayST.py:75: FutureWarning: Use `squidpy.read.visium` instead.
  adata_h5 = sc.read_visium(path=args.data_from, count_file='filtered_feature_bc_matrix.h5')
/Users/krysten/anaconda3/lib/python3.11/site-packages/anndata/_core/anndata.py:1793: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/Users/krysten/anaconda3/lib/python3.11/site-packages/anndata/_core/anndata.py:1793: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/Users/krysten/anaconda3/lib/python3.11/site-packages/anndata/_core/anndata.py:1793: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
package loading
user input reading
Input data reading
input data read done
Gene filtering done. Number of genes reduced from 36601 to 25187
Number of barcodes: 4035
Applying quantile normalization
Build physical distance matrix
Neighborhood distance is set to be 548 (same unit as the coordinates)
Assign weight to the neighborhood relations based on neighborhood distance
Auto calculated juxtacrine distance is 89.49. To change it use --juxtacrine_distance
Loading signature database for bias calculation...
Loaded 1022 signature entries
Created signature bias lookup for 28823 ligand-receptor pairs
ligand-receptor database reading.
ligand-receptor database reading done.
Preprocess start.
number of ligands 630 
Total genes in this dataset: 25187, number of genes working as ligand and/or receptor: 1306 
number of ligand-receptor pairs in this dataset 9050 
set threshold gene percentile done
some preprocessing before making the input graph
1/630 ligand genes processed2/630 ligand genes processed3/630 ligand genes processed4/630 ligand genes processed5/630 ligand genes processed6/630 ligand genes processed7/630 ligand genes processed8/630 ligand genes processed9/630 ligand genes processed10/630 ligand genes processed11/630 ligand genes processed12/630 ligand genes processed13/630 ligand genes processed14/630 ligand genes processed15/630 ligand genes processed16/630 ligand genes processed17/630 ligand genes processed18/630 ligand genes processed19/630 ligand genes processed20/630 ligand genes processed21/630 ligand genes processed22/630 ligand genes processed23/630 ligand genes processed24/630 ligand genes processed25/630 ligand genes processed26/630 ligand genes processed27/630 ligand genes processed28/630 ligand genes processed29/630 ligand genes processed30/630 ligand genes processed31/630 ligand genes processed32/630 ligand genes processed33/630 ligand genes processed34/630 ligand genes processed35/630 ligand genes processed36/630 ligand genes processed37/630 ligand genes processed38/630 ligand genes processed39/630 ligand genes processed40/630 ligand genes processed41/630 ligand genes processed42/630 ligand genes processed43/630 ligand genes processed44/630 ligand genes processed45/630 ligand genes processed46/630 ligand genes processed47/630 ligand genes processed48/630 ligand genes processed49/630 ligand genes processed50/630 ligand genes processed51/630 ligand genes processed52/630 ligand genes processed53/630 ligand genes processed54/630 ligand genes processed55/630 ligand genes processed56/630 ligand genes processed57/630 ligand genes processed58/630 ligand genes processed59/630 ligand genes processed60/630 ligand genes processed61/630 ligand genes processed62/630 ligand genes processed63/630 ligand genes processed64/630 ligand genes processed65/630 ligand genes processed66/630 ligand genes processed67/630 ligand genes processed68/630 ligand genes processed69/630 ligand genes processed70/630 ligand genes processed71/630 ligand genes processed72/630 ligand genes processed73/630 ligand genes processed74/630 ligand genes processed75/630 ligand genes processed76/630 ligand genes processed77/630 ligand genes processed78/630 ligand genes processed79/630 ligand genes processed80/630 ligand genes processed81/630 ligand genes processed82/630 ligand genes processed83/630 ligand genes processed84/630 ligand genes processed85/630 ligand genes processed86/630 ligand genes processed87/630 ligand genes processed88/630 ligand genes processed89/630 ligand genes processed90/630 ligand genes processed91/630 ligand genes processed92/630 ligand genes processed93/630 ligand genes processed94/630 ligand genes processed95/630 ligand genes processed96/630 ligand genes processed97/630 ligand genes processed98/630 ligand genes processed99/630 ligand genes processed100/630 ligand genes processed101/630 ligand genes processed102/630 ligand genes processed103/630 ligand genes processed104/630 ligand genes processed105/630 ligand genes processed106/630 ligand genes processed107/630 ligand genes processed108/630 ligand genes processed109/630 ligand genes processed110/630 ligand genes processed111/630 ligand genes processed112/630 ligand genes processed113/630 ligand genes processed114/630 ligand genes processed115/630 ligand genes processed116/630 ligand genes processed117/630 ligand genes processed118/630 ligand genes processed119/630 ligand genes processed120/630 ligand genes processed121/630 ligand genes processed122/630 ligand genes processed123/630 ligand genes processed124/630 ligand genes processed125/630 ligand genes processed126/630 ligand genes processed127/630 ligand genes processed128/630 ligand genes processed129/630 ligand genes processed130/630 ligand genes processed131/630 ligand genes processed132/630 ligand genes processed133/630 ligand genes processed134/630 ligand genes processed135/630 ligand genes processed136/630 ligand genes processed137/630 ligand genes processed138/630 ligand genes processed139/630 ligand genes processed140/630 ligand genes processed141/630 ligand genes processed142/630 ligand genes processed143/630 ligand genes processed144/630 ligand genes processed145/630 ligand genes processed146/630 ligand genes processed147/630 ligand genes processed148/630 ligand genes processed149/630 ligand genes processed150/630 ligand genes processed151/630 ligand genes processed152/630 ligand genes processed153/630 ligand genes processed154/630 ligand genes processed155/630 ligand genes processed156/630 ligand genes processed157/630 ligand genes processed158/630 ligand genes processed159/630 ligand genes processed160/630 ligand genes processed161/630 ligand genes processed162/630 ligand genes processed163/630 ligand genes processed164/630 ligand genes processed165/630 ligand genes processed166/630 ligand genes processed167/630 ligand genes processed168/630 ligand genes processed169/630 ligand genes processed170/630 ligand genes processed171/630 ligand genes processed172/630 ligand genes processed173/630 ligand genes processed174/630 ligand genes processed175/630 ligand genes processed176/630 ligand genes processed177/630 ligand genes processed178/630 ligand genes processed179/630 ligand genes processed180/630 ligand genes processed181/630 ligand genes processed182/630 ligand genes processed183/630 ligand genes processed184/630 ligand genes processed185/630 ligand genes processed186/630 ligand genes processed187/630 ligand genes processed188/630 ligand genes processed189/630 ligand genes processed190/630 ligand genes processed191/630 ligand genes processed192/630 ligand genes processed193/630 ligand genes processed194/630 ligand genes processed195/630 ligand genes processed196/630 ligand genes processed197/630 ligand genes processed198/630 ligand genes processed199/630 ligand genes processed200/630 ligand genes processed201/630 ligand genes processed202/630 ligand genes processed203/630 ligand genes processed204/630 ligand genes processed205/630 ligand genes processed206/630 ligand genes processed207/630 ligand genes processed208/630 ligand genes processed209/630 ligand genes processed210/630 ligand genes processed211/630 ligand genes processed212/630 ligand genes processed213/630 ligand genes processed214/630 ligand genes processed215/630 ligand genes processed216/630 ligand genes processed217/630 ligand genes processed218/630 ligand genes processed219/630 ligand genes processed220/630 ligand genes processed221/630 ligand genes processed222/630 ligand genes processed223/630 ligand genes processed224/630 ligand genes processed225/630 ligand genes processed226/630 ligand genes processed227/630 ligand genes processed228/630 ligand genes processed229/630 ligand genes processed230/630 ligand genes processed231/630 ligand genes processed232/630 ligand genes processed233/630 ligand genes processed234/630 ligand genes processed235/630 ligand genes processed236/630 ligand genes processed237/630 ligand genes processed238/630 ligand genes processed239/630 ligand genes processed240/630 ligand genes processed241/630 ligand genes processed242/630 ligand genes processed243/630 ligand genes processed244/630 ligand genes processed245/630 ligand genes processed246/630 ligand genes processed247/630 ligand genes processed248/630 ligand genes processed249/630 ligand genes processed250/630 ligand genes processed251/630 ligand genes processed252/630 ligand genes processed253/630 ligand genes processed254/630 ligand genes processed255/630 ligand genes processed256/630 ligand genes processed257/630 ligand genes processed258/630 ligand genes processed259/630 ligand genes processed260/630 ligand genes processed261/630 ligand genes processed262/630 ligand genes processed263/630 ligand genes processed264/630 ligand genes processed265/630 ligand genes processed266/630 ligand genes processed267/630 ligand genes processed268/630 ligand genes processed269/630 ligand genes processed270/630 ligand genes processed271/630 ligand genes processed272/630 ligand genes processed273/630 ligand genes processed274/630 ligand genes processed275/630 ligand genes processed276/630 ligand genes processed277/630 ligand genes processed278/630 ligand genes processed279/630 ligand genes processed280/630 ligand genes processed281/630 ligand genes processed282/630 ligand genes processed283/630 ligand genes processed284/630 ligand genes processed285/630 ligand genes processed286/630 ligand genes processed287/630 ligand genes processed288/630 ligand genes processed289/630 ligand genes processed290/630 ligand genes processed291/630 ligand genes processed292/630 ligand genes processed293/630 ligand genes processed294/630 ligand genes processed295/630 ligand genes processed296/630 ligand genes processed297/630 ligand genes processed298/630 ligand genes processed299/630 ligand genes processed300/630 ligand genes processed301/630 ligand genes processed302/630 ligand genes processed303/630 ligand genes processed304/630 ligand genes processed305/630 ligand genes processed306/630 ligand genes processed307/630 ligand genes processed308/630 ligand genes processed309/630 ligand genes processed310/630 ligand genes processed311/630 ligand genes processed312/630 ligand genes processed313/630 ligand genes processed314/630 ligand genes processed315/630 ligand genes processed316/630 ligand genes processed317/630 ligand genes processed318/630 ligand genes processed319/630 ligand genes processed320/630 ligand genes processed321/630 ligand genes processed322/630 ligand genes processed323/630 ligand genes processed324/630 ligand genes processed325/630 ligand genes processed326/630 ligand genes processed327/630 ligand genes processed328/630 ligand genes processed329/630 ligand genes processed330/630 ligand genes processed331/630 ligand genes processed332/630 ligand genes processed333/630 ligand genes processed334/630 ligand genes processed335/630 ligand genes processed336/630 ligand genes processed337/630 ligand genes processed338/630 ligand genes processed339/630 ligand genes processed340/630 ligand genes processed341/630 ligand genes processed342/630 ligand genes processed343/630 ligand genes processed344/630 ligand genes processed345/630 ligand genes processed346/630 ligand genes processed347/630 ligand genes processed348/630 ligand genes processed349/630 ligand genes processed350/630 ligand genes processed351/630 ligand genes processed352/630 ligand genes processed353/630 ligand genes processed354/630 ligand genes processed355/630 ligand genes processed356/630 ligand genes processed357/630 ligand genes processed358/630 ligand genes processed359/630 ligand genes processed360/630 ligand genes processed361/630 ligand genes processed362/630 ligand genes processed363/630 ligand genes processed364/630 ligand genes processed365/630 ligand genes processed366/630 ligand genes processed367/630 ligand genes processed368/630 ligand genes processed369/630 ligand genes processed370/630 ligand genes processed371/630 ligand genes processed372/630 ligand genes processed373/630 ligand genes processed374/630 ligand genes processed375/630 ligand genes processed376/630 ligand genes processed377/630 ligand genes processed378/630 ligand genes processed379/630 ligand genes processed380/630 ligand genes processed381/630 ligand genes processed382/630 ligand genes processed383/630 ligand genes processed384/630 ligand genes processed385/630 ligand genes processed386/630 ligand genes processed387/630 ligand genes processed388/630 ligand genes processed389/630 ligand genes processed390/630 ligand genes processed391/630 ligand genes processed392/630 ligand genes processed393/630 ligand genes processed394/630 ligand genes processed395/630 ligand genes processed396/630 ligand genes processed397/630 ligand genes processed398/630 ligand genes processed399/630 ligand genes processed400/630 ligand genes processed401/630 ligand genes processed402/630 ligand genes processed403/630 ligand genes processed404/630 ligand genes processed405/630 ligand genes processed406/630 ligand genes processed407/630 ligand genes processed408/630 ligand genes processed409/630 ligand genes processed410/630 ligand genes processed411/630 ligand genes processed412/630 ligand genes processed413/630 ligand genes processed414/630 ligand genes processed415/630 ligand genes processed416/630 ligand genes processed417/630 ligand genes processed418/630 ligand genes processed419/630 ligand genes processed420/630 ligand genes processed421/630 ligand genes processed422/630 ligand genes processed423/630 ligand genes processed424/630 ligand genes processed425/630 ligand genes processed426/630 ligand genes processed427/630 ligand genes processed428/630 ligand genes processed429/630 ligand genes processed430/630 ligand genes processed431/630 ligand genes processed432/630 ligand genes processed433/630 ligand genes processed434/630 ligand genes processed435/630 ligand genes processed436/630 ligand genes processed437/630 ligand genes processed438/630 ligand genes processed439/630 ligand genes processed440/630 ligand genes processed441/630 ligand genes processed442/630 ligand genes processed443/630 ligand genes processed444/630 ligand genes processed445/630 ligand genes processed446/630 ligand genes processed447/630 ligand genes processed448/630 ligand genes processed449/630 ligand genes processed450/630 ligand genes processed451/630 ligand genes processed452/630 ligand genes processed453/630 ligand genes processed454/630 ligand genes processed455/630 ligand genes processed456/630 ligand genes processed457/630 ligand genes processed458/630 ligand genes processed459/630 ligand genes processed460/630 ligand genes processed461/630 ligand genes processed462/630 ligand genes processed463/630 ligand genes processed464/630 ligand genes processed465/630 ligand genes processed466/630 ligand genes processed467/630 ligand genes processed468/630 ligand genes processed469/630 ligand genes processed470/630 ligand genes processed471/630 ligand genes processed472/630 ligand genes processed473/630 ligand genes processed474/630 ligand genes processed475/630 ligand genes processed476/630 ligand genes processed477/630 ligand genes processed478/630 ligand genes processed479/630 ligand genes processed480/630 ligand genes processed481/630 ligand genes processed482/630 ligand genes processed483/630 ligand genes processed484/630 ligand genes processed485/630 ligand genes processed486/630 ligand genes processed487/630 ligand genes processed488/630 ligand genes processed489/630 ligand genes processed490/630 ligand genes processed491/630 ligand genes processed492/630 ligand genes processed493/630 ligand genes processed494/630 ligand genes processed495/630 ligand genes processed496/630 ligand genes processed497/630 ligand genes processed498/630 ligand genes processed499/630 ligand genes processed500/630 ligand genes processed501/630 ligand genes processed502/630 ligand genes processed503/630 ligand genes processed504/630 ligand genes processed505/630 ligand genes processed506/630 ligand genes processed507/630 ligand genes processed508/630 ligand genes processed509/630 ligand genes processed510/630 ligand genes processed511/630 ligand genes processed512/630 ligand genes processed513/630 ligand genes processed514/630 ligand genes processed515/630 ligand genes processed516/630 ligand genes processed517/630 ligand genes processed518/630 ligand genes processed519/630 ligand genes processed520/630 ligand genes processed521/630 ligand genes processed522/630 ligand genes processed523/630 ligand genes processed524/630 ligand genes processed525/630 ligand genes processed526/630 ligand genes processed527/630 ligand genes processed528/630 ligand genes processed529/630 ligand genes processed530/630 ligand genes processed531/630 ligand genes processed532/630 ligand genes processed533/630 ligand genes processed534/630 ligand genes processed535/630 ligand genes processed536/630 ligand genes processed537/630 ligand genes processed538/630 ligand genes processed539/630 ligand genes processed540/630 ligand genes processed541/630 ligand genes processed542/630 ligand genes processed543/630 ligand genes processed544/630 ligand genes processed545/630 ligand genes processed546/630 ligand genes processed547/630 ligand genes processed548/630 ligand genes processed549/630 ligand genes processed550/630 ligand genes processed551/630 ligand genes processed552/630 ligand genes processed553/630 ligand genes processed554/630 ligand genes processed555/630 ligand genes processed556/630 ligand genes processed557/630 ligand genes processed558/630 ligand genes processed559/630 ligand genes processed560/630 ligand genes processed561/630 ligand genes processed562/630 ligand genes processed563/630 ligand genes processed564/630 ligand genes processed565/630 ligand genes processed566/630 ligand genes processed567/630 ligand genes processed568/630 ligand genes processed569/630 ligand genes processed570/630 ligand genes processed571/630 ligand genes processed572/630 ligand genes processed573/630 ligand genes processed574/630 ligand genes processed575/630 ligand genes processed576/630 ligand genes processed577/630 ligand genes processed578/630 ligand genes processed579/630 ligand genes processed580/630 ligand genes processed581/630 ligand genes processed582/630 ligand genes processed583/630 ligand genes processed584/630 ligand genes processed585/630 ligand genes processed586/630 ligand genes processed587/630 ligand genes processed588/630 ligand genes processed589/630 ligand genes processed590/630 ligand genes processed591/630 ligand genes processed592/630 ligand genes processed593/630 ligand genes processed594/630 ligand genes processed595/630 ligand genes processed596/630 ligand genes processed597/630 ligand genes processed598/630 ligand genes processed599/630 ligand genes processed600/630 ligand genes processed601/630 ligand genes processed602/630 ligand genes processed603/630 ligand genes processed604/630 ligand genes processed605/630 ligand genes processed606/630 ligand genes processed607/630 ligand genes processed608/630 ligand genes processed609/630 ligand genes processed610/630 ligand genes processed611/630 ligand genes processed612/630 ligand genes processed613/630 ligand genes processed614/630 ligand genes processed615/630 ligand genes processed616/630 ligand genes processed617/630 ligand genes processed618/630 ligand genes processed619/630 ligand genes processed620/630 ligand genes processed621/630 ligand genes processed622/630 ligand genes processed623/630 ligand genes processed624/630 ligand genes processed625/630 ligand genes processed626/630 ligand genes processed627/630 ligand genes processed628/630 ligand genes processed629/630 ligand genes processed630/630 ligand genes processed
total number of nodes is 4035, and edges is 308452 in the input graph
Edge attributes dimension: 4 (includes signature bias)
Edges with signature bias > 0: 68663 (22.3%)
preprocess done.
writing data ...
write data done
